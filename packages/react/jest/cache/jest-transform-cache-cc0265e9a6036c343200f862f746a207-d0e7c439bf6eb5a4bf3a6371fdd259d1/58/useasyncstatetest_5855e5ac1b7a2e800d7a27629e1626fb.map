{"file":"/Users/jiangwei/projects/lotips/packages/react/test/use-async-state.test.tsx","mappings":";;;AAAA,qDAA8D;AAC9D,4DAA8D;AAE9D,0DAAsD;AAEtD,IAAM,iBAAiB,GAAG,eAAK,CAAC,aAAa,CAAC,CAAC,CAAC,CAAA;AAEhD,IAAM,kBAAkB,GAAG,UAAC,EAAY;QAAV,sBAAQ;IAC9B,IAAA,wBAA+B,EAA9B,aAAK,EAAE,gBAAuB,CAAA;IACrC,iBAAS,CAAC;QACR,UAAU,CAAC;YACT,QAAQ,CAAC,CAAC,CAAC,CAAA;QACb,CAAC,EAAE,IAAI,CAAC,CAAA;IACV,CAAC,EAAE,EAAE,CAAC,CAAA;IACN,OAAO,8BAAC,iBAAiB,CAAC,QAAQ,IAAC,KAAK,EAAE,KAAK,IAAG,QAAQ,CAA8B,CAAA;AAC1F,CAAC,CAAA;AAED,IAAM,cAAc,GAAG,UAAC,SAAqB;IAArB,0BAAA,EAAA,qBAAqB;IAC3C,IAAM,KAAK,GAAG,kBAAU,CAAC,iBAAiB,CAAC,CAAA;IACrC,IAAA,qEAAkD,EAAjD,aAAK,EAAE,WAA0C,CAAA;IACxD,OAAO;QACL,KAAK,OAAA;QACL,GAAG,KAAA;KACJ,CAAA;AACH,CAAC,CAAA;AAED,QAAQ,CAAC,iBAAiB,EAAE;IAC1B,IAAI,CAAC,iCAAiC,EAAE;;;;;oBAChC,IAAI,GAAG,wBAAU,CAAC,cAAM,OAAA,cAAc,EAAE,EAAhB,CAAgB,EAAE,EAAE,OAAO,EAAE,kBAAkB,EAAE,CAAC,CAAA;oBAChF,qBAAM,IAAI,CAAC,iBAAiB,EAAE,EAAA;;oBAA9B,SAA8B,CAAA;oBAC9B,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;;;;SAC1C,CAAC,CAAA;IAEF,IAAI,CAAC,sDAAsD,EAAE;;;;;oBACrD,IAAI,GAAG,wBAAU,CAAC,cAAM,OAAA,cAAc,EAAE,EAAhB,CAAgB,EAAE,EAAE,OAAO,EAAE,kBAAkB,EAAE,CAAC,CAAA;oBAChF,qBAAM,IAAI,CAAC,iBAAiB,EAAE,EAAA;;oBAA9B,SAA8B,CAAA;oBAC9B,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;oBACzC,iBAAG,CAAC;wBACF,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;oBAC5B,CAAC,CAAC,CAAA;oBACF,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;;;;SAC1C,CAAC,CAAA;IAEF,IAAI,CAAC,wCAAwC,EAAE;;;;;oBAGvC,IAAI,GAAG,wBAAU,CAAC,cAAM,OAAA,cAAc,CAAC,CAAC,CAAC,EAAjB,CAAiB,EAAE,EAAE,OAAO,EAAE,kBAAkB,EAAE,CAAC,CAAA;oBACjF,qBAAM,IAAI,CAAC,iBAAiB,EAAE,EAAA;;oBAA9B,SAA8B,CAAA;oBAC9B,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;oBACzC,iBAAG,CAAC;wBACF,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;oBAC5B,CAAC,CAAC,CAAA;oBACF,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;;;;SAC1C,CAAC,CAAA;AACJ,CAAC,CAAC,CAAA","names":[],"sources":["/Users/jiangwei/projects/lotips/packages/react/test/use-async-state.test.tsx"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react'\nimport { renderHook, act } from '@testing-library/react-hooks'\n\nimport { useAsyncState } from '../src/use-async-state'\n\nconst AsyncStateContext = React.createContext(1)\n\nconst AsyncStateProvider = ({ children }) => {\n  const [value, setValue] = useState(1)\n  useEffect(() => {\n    setTimeout(() => {\n      setValue(2)\n    }, 1000)\n  }, [])\n  return <AsyncStateContext.Provider value={value}>{children}</AsyncStateContext.Provider>\n}\n\nconst _useAsyncState = (nullstate = undefined) => {\n  const value = useContext(AsyncStateContext)\n  const [state, set] = useAsyncState(value, { nullstate })\n  return {\n    state,\n    set,\n  }\n}\n\ndescribe('use-async-state', () => {\n  test('should be inited by async value', async () => {\n    const hook = renderHook(() => _useAsyncState(), { wrapper: AsyncStateProvider })\n    await hook.waitForNextUpdate()\n    expect(hook.result.current.state).toBe(2)\n  })\n\n  test('initial async value should be rewrited by manual set', async () => {\n    const hook = renderHook(() => _useAsyncState(), { wrapper: AsyncStateProvider })\n    await hook.waitForNextUpdate()\n    expect(hook.result.current.state).toBe(2)\n    act(() => {\n      hook.result.current.set(3)\n    })\n    expect(hook.result.current.state).toBe(3)\n  })\n\n  test('nullstate value availabled be configed', async () => {\n    // nullstate值不再是undefined, 而是0\n    // 一旦nullstate设置为0, 当通过set之后将会重新使用async state\n    const hook = renderHook(() => _useAsyncState(0), { wrapper: AsyncStateProvider })\n    await hook.waitForNextUpdate()\n    expect(hook.result.current.state).toBe(2)\n    act(() => {\n      hook.result.current.set(0)\n    })\n    expect(hook.result.current.state).toBe(2)\n  })\n})\n"],"version":3}